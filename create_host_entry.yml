- set_fact:
    nodename: "{{ hostvars[item].ansible_host }}

- name: run ssh-keyscan on the jumphost to get the host key of the managed host.
  command: "ssh-keygen {{ nodename }}"
  register: host_fingerprint
  delegate_to: jumphost

- name: add host behind the ssh-proxy to the tower awx known host
  known_hosts:
    key: "{{ host_fingerprint.stdout }}"
    name: "{{ nodename }}"
