- set_fact:
    nodename: "{{ hostvars[item].ansible_host }}"

- name: run ssh-keyscan on the jumphost to get the host key of the managed host.
  command: "ssh-keyscan {{ nodename }}"
  register: host_fingerprint
  delegate_to: jumphost

- name: add ssh host key to awx known_host file
  - lineinfile:
      dest: "{{ ansible_user_dir }}/.ssh/known_hosts"
      line: "{{ host_fingerprint.stdout }}"
